---
import NavbarContent from './shared/NavbarContent.astro';
import '@styles/global.css';

let starCountDisplay = process.env.GITHUB_STARS || '8.6k';

try {
    // Only fetch if not in environment variable
    if (!process.env.GITHUB_STARS) {
        const response = await fetch('https://api.github.com/repos/gruntwork-io/terragrunt', {
            headers: {
                'User-Agent': 'Terragrunt-Docs'
            }
        });
        if (response.ok) {
            const data = await response.json();
            const stars = data.stargazers_count;
            if (typeof stars === 'number') {
                starCountDisplay = (stars / 1000).toFixed(1) + 'k';
            }
        } else {
            console.error('Failed to fetch GitHub stars:', response.status, await response.text());
        }
    }
} catch (error) {
    console.error('Error fetching GitHub stars:', error);
}
---
<nav class="z-50 flex flex-col">
    <div class="navbar">
        <NavbarContent
            starCountDisplay={starCountDisplay}
            showThemeToggle={false}
        />
    </div>
</nav>
