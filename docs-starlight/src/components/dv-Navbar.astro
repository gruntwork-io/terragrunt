---
import NavbarContent from './shared/NavbarContent.astro';
import '@styles/global.css';

let starCountDisplay = process.env.GITHUB_STARS || '8.6k';

try {
    // Only fetch if not in environment variable
    if (!process.env.GITHUB_STARS) {
        const response = await fetch('https://api.github.com/repos/gruntwork-io/terragrunt', {
            headers: {
                'User-Agent': 'Terragrunt-Docs'
            }
        });
        if (response.ok) {
            const data = await response.json();
            const stars = data.stargazers_count;
            if (typeof stars === 'number') {
                starCountDisplay = (stars / 1000).toFixed(1) + 'k';
            }
        } else {
            console.error('Failed to fetch GitHub stars:', response.status, await response.text());
        }
    }
} catch (error) {
    console.error('Error fetching GitHub stars:', error);
}
---
<nav class="z-50 flex flex-col">
    <div class="navbar">
        <NavbarContent
            starCountDisplay={starCountDisplay}
            showThemeToggle={false}
        />
    </div>
</nav>

<style>
    .navbar {
        display: flex;
        width: 100vw;
        height: auto;
        align-items: center;
        justify-content: space-between;
        background-color: var(--color-bg-dark);
        padding: 20px 80px;
        border-bottom: 1px solid var(--color-stroke-dark);
    }

    @media (width <= 1024px) {
        .navbar {
            padding: 20px;
        }
    }

    .searchbar {
        display: flex;
        align-items: center;
        justify-content: start;
        gap: 8px;
        width: 280px;
        height: 40px;
        padding: 6px 12px;
        background-color: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 6px;
    }

    .menu-icon {
        display: none;
    }

    @media (min-width: 768px) and (max-width: 1023px) {
        .menu-icon {
            display: inline-flex;
        }
    }

    @media (width <= 375px) {
        .primary-button, .secondary-button {
            padding: 10px 10px;
        }
    }
</style>
